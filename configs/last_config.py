config_dict = {'name': 'udis', 'gamma': 0.8, 'stage': 'udis_flowadapter_final_final', 'suffix': 'udis_flowadapter_final_final_weight_0.3_canny_False', 'log_dir': '/workspace/FlowFormerPlusPlus/logs/udis/percostformer3/5cnprry9', 'trainer': {'clip': 1, 'epsilon': 1e-08, 'num_steps': 31323, 'optimizer': 'adamw', 'scheduler': 'OneCycleLR', 'adamw_decay': 0.0001, 'canonical_lr': 3.125e-06, 'anneal_strategy': 'linear'}, 'detach_H': False, 'max_flow': 500, 'sum_freq': 100, 'use_ssim': False, 'val_freq': 5000, 'add_noise': False, 'only_homo': False, 'use_wandb': True, 'batch_size': 1, 'image_size': [512, 512], 'no_gt_flow': True, 'use_foward': False, 'validation': None, 'wandb_mode': 'online', 'wandb_name': 'FlowFormerPlusPlus_udis_flowadapter_final_final_weight_0.3_canny_False', 'detach_flow': False, 'transformer': 'percostformer3', 'depth_weight': 0, 'random_img12': True, 'restore_ckpt': None, 'udis_dataset': {'data_dir': '/workspace/data/UDIS/UDIS-D/', 'return_depth': False}, 'use_smoothl1': False, 'flow_backbone': 'flowformerpp', 'homo_backbone': 'udis2', 'loss_2_weight': 1, 'wandb_project': 'FlowFormerPlusPlus', 'init_flow_ckpt': 'checkpoints/things_288960.pth', 'init_homo_ckpt': '/workspace/UDIS2/Warp/model/epoch100_model.pth', 'percostformer3': {'pe': 'linear', 'gma': 'GMA', 'cnet': 'twins', 'fnet': 'twins', 'gt_r': 15, 'r_16': -1, 'no_sc': False, 'fix_pe': False, 'dropout': 0, 'use_rpe': False, 'H_offset': 0, 'W_offset': 0, 'attn_dim': 128, 'droppath': 0, 'pic_size': [368, 496, 368, 496], 'pretrain': True, 'no_border': True, 'query_num': 30, 'use_patch': False, 'cross_attn': 'all', 'del_layers': True, 'flow_or_pe': 'and', 'mask_ratio': 0.5, 'patch_size': 8, 'vert_c_dim': 64, 'patch_embed': 'single', 'detach_local': False, 'decoder_depth': 12, 'encoder_depth': 3, 'expand_factor': 4, 'pretrain_mode': False, 'quater_refine': False, 'use_convertor': False, 'cost_heads_num': 1, 'cost_latent_dim': 128, 'critical_params': ['vert_c_dim', 'encoder_depth', 'vertical_encoder_attn', 'use_patch', 'flow_or_pe', 'use_rpe', 'dropout', 'detach_local', 'expand_factor'], 'cost_encoder_res': True, 'query_latent_dim': 64, 'encoder_latent_dim': 256, 'cost_latent_input_dim': 64, 'cost_latent_token_num': 8, 'vertical_encoder_attn': 'twins'}, 'use_valid_mask': True, 'critical_params': [], 'mixed_precision': True, 'use_canny_weight': False, 'weight_mask_type': 'occlusion', 'border_loss_weight': 0.5, 'use_combine_h_flow': False, 'is_zero_flow_in_edge': True, 'train_foward_backward': False, 'use_rigid_motion_loss': True, 'use_fb_consistency_mask': True, 'is_normalize_before_loss': False, 'rigid_motion_loss_weight': 0.3, 'rigid_motion_with_h_flow': False, 'only_calculate_on_inv_mask': True, 'not_process_transformer_cfg': True}
